from google import genai
import config
import asyncio

# –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –∫–ª—ñ—î–Ω—Ç–∞ –Ω–æ–≤–æ—ó –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏
client = genai.Client(api_key=config.GEMINI_API_KEY)

async def generate_disaster():
    prompt = (
        "–ó–≥–µ–Ω–µ—Ä—É–π —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π —Å—Ü–µ–Ω–∞—Ä—ñ–π –≥—Ä–∏ ‚Äú–ë—É–Ω–∫–µ—Ä‚Äù —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é –º–æ–≤–æ—é. "
        "–°–£–í–û–†–û –î–û–¢–†–ò–ú–£–ô–°–Ø —à–∞–±–ª–æ–Ω—É –Ω–∏–∂—á–µ: "
        "\n\n–®–ê–ë–õ–û–ù:\n"
        "–û–ø–∏—Å –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∏: _____________\n\n"
        "–í–Ω–∞—Å–ª—ñ–¥–æ–∫ —Ü—å–æ–≥–æ _, —ñ –ø–µ—Ä–µ–±—É–≤–∞–Ω–Ω—è –Ω–∞ –ø–æ–≤–µ—Ä—Ö–Ω—ñ —Å—Ç–∞–ª–æ _.\n"
        "–í–∏ –ø–µ—Ä–µ–±—É–≤–∞—î—Ç–µ –≤ _–±—É–Ω–∫–µ—Ä—ñ. (–¥–µ—Ç–∞–ª—å–Ω–∏–π –æ–ø–∏—Å –±—É–Ω–∫–µ—Ä–∞) \n\n"
        "–ß–∞—Å –ø–µ—Ä–µ–±—É–≤–∞–Ω–Ω—è –≤ –±—É–Ω–∫–µ—Ä—ñ _(–≤—ñ–¥ 1 –¥–æ 10 —Ä–æ–∫—ñ–≤)\n"
        "–ó–∞–ø–∞—Å–∏ —ó–∂—ñ —Ç–∞ –≤–æ–¥–∏ —Ä–æ–∑—Ä–∞—Ö–æ–≤–∞–Ω—ñ –ø—Ä–∏–±–ª–∏–∑–Ω–æ –Ω–∞ _ —Ä–æ–∫—ñ–≤. –ü–æ–ø–æ–≤–Ω–µ–Ω–Ω—è –∑–∞–ø–∞—Å—ñ–≤ _. –î–∂–µ—Ä–µ–ª–æ–º –µ–ª–µ–∫—Ç—Ä–æ–µ–Ω–µ—Ä–≥—ñ—ó —î _, –∑–∞–ø–∞—Å—ñ–≤ —è–∫–æ–≥–æ –≤–∏—Å—Ç–∞—á–∏—Ç—å –Ω–∞ _ —Ä–æ–∫—ñ–≤.\n"
        "–£–º–æ–≤–∏ –ø—Ä–æ–∂–∏–≤–∞–Ω–Ω—è –≤ –±—É–Ω–∫–µ—Ä—ñ –≤–∫–ª—é—á–∞—é—Ç—å _. –ú–µ–¥–∏—á–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –æ–±–º–µ–∂—É—é—Ç—å—Å—è _. –†—ñ–≤–µ–Ω—å –±–µ–∑–ø–µ–∫–∏ –±—É–Ω–∫–µ—Ä–∞ _.\n"
        "–í–∞—à–µ –∑–∞–≤–¥–∞–Ω–Ω—è - –≤–∏—Ä—ñ—à–∏—Ç–∏, —Ö—Ç–æ –∑–∞–ª–∏—à–∏—Ç—å—Å—è –≤ –±—É–Ω–∫–µ—Ä—ñ, –∞ —Ö—Ç–æ –±—É–¥–µ –∑–º—É—à–µ–Ω–∏–π –ø–æ–∫–∏–Ω—É—Ç–∏ –π–æ–≥–æ, –∞—Ä–≥—É–º–µ–Ω—Ç—É—é—á–∏ —Ü–µ —Å–≤–æ—ó–º–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏."
    )

    try:
        # –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∏–π –≤–∏–∫–ª–∏–∫ –¥–ª—è –Ω–æ–≤–æ—ó –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏
        response = await client.aio.models.generate_content(
            model='gemini-2.5-flash', 
            contents=prompt
        )
        return response.text
    except Exception as e:
        print(f"‚ùå –ü–û–ú–ò–õ–ö–ê AI (Disaster): {e}")
        return "‚ö†Ô∏è –°–≤—ñ—Ç –∑—Ä—É–π–Ω–æ–≤–∞–Ω–æ. –ó–≤'—è–∑–æ–∫ —ñ–∑ –®–Ü –≤—Ç—Ä–∞—á–µ–Ω–æ. –í–∏–∂–∏–≤–∞–π—Ç–µ —è–∫ –º–æ–∂–µ—Ç–µ."

async def analyze_survival(disaster, survivors_text):
    prompt = (
        f"–ì–†–ê '–ë–£–ù–ö–ï–†' –ó–ê–í–ï–†–®–ï–ù–ê. –ü–û–¢–†–Ü–ë–ï–ù –§–Ü–ù–ê–õ.\n\n"
        f"üåç –ö–ê–¢–ê–°–¢–†–û–§–ê: {disaster}\n\n"
        f"üë• –°–ü–ò–°–û–ö –¢–ò–•, –•–¢–û –í–ò–ñ–ò–í:\n{survivors_text}\n\n"
        f"–ó–ê–í–î–ê–ù–ù–Ø: –ü—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–π, —á–∏ –∑–º–æ–∂–µ —Ü—è –≥—Ä—É–ø–∞ –≤–∏–∂–∏—Ç–∏. –ë—É–¥—å —Å–∞—Ä–∫–∞—Å—Ç–∏—á–Ω–∏–º. –ü–∏—à–∏ —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é."
    )
    
    try:
        response = await client.aio.models.generate_content(
            model='gemini-2.5-flash', 
            contents=prompt
        )
        return response.text
    except Exception as e:
        print(f"‚ùå –ü–û–ú–ò–õ–ö–ê AI (Analyze): {e}")
        return f"–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ —Ñ—ñ–Ω–∞–ª. –ü–æ–º–∏–ª–∫–∞: {e}"
