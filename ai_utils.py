from google import genai
import config
import asyncio

# –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –∫–ª—ñ—î–Ω—Ç–∞ –Ω–æ–≤–æ—ó –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏
client = genai.Client(api_key=config.GEMINI_API_KEY)

async def generate_disaster():
    prompt = (
        "–ó–≥–µ–Ω–µ—Ä—É–π —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π —Å—Ü–µ–Ω–∞—Ä—ñ–π –≥—Ä–∏ ‚Äú–ë—É–Ω–∫–µ—Ä‚Äù —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é –º–æ–≤–æ—é. "
        "–î–µ—Ç–∞–ª—å–Ω–æ –æ–ø–∏—à–∏ –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ—É —Ç–∞ —É–º–æ–≤–∏ –≤ –±—É–Ω–∫–µ—Ä—ñ, —Ä–æ–∑–º–≤—ñ—Ä, —â–æ –≤ –Ω—å–æ–º—É —î —ñ —á–æ–≥–æ –Ω–µ–º–∞—î, —Å–∫—ñ–ª—å–∫–∏ —á–∞—Å—É –∑–Ω–∞—Ö–æ–¥–∏—Ç–∏—Å—å –≤ –±—É–Ω–∫–µ—Ä—ñ(–≤—ñ–¥ 6 –º—ñ—Å—è—Ü—ñ–≤ –¥–æ 7 —Ä–æ–∫—ñ–≤) "
        "–ù–∞–ø–∏—à–∏ –ø–ª—é—Å–∏ —Ç–∞ –º—ñ–Ω—É—Å–∏ –±—É–Ω–∫–µ—Ä–∞, –Ω–∞ —Å–∫—ñ–ª—å–∫–∏ –≤–∏—Å—Ç–∞—á–∏—Ç—å –ø—Ä–æ–¥–æ–≤–æ–ª—å—Å—Ç–≤–∞ —ñ —Ç–¥ "
        "–í–ê–ñ–õ–ò–í–û: –£—Å—ñ —É—á–∞—Å–Ω–∏–∫–∏ –≥—Ä–∏ —î –ø–æ–≤–Ω–æ–ª—ñ—Ç–Ω—ñ–º–∏. –î–æ–∑–≤–æ–ª—è—î—Ç—å—Å—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Å–µ—Ä–π–æ–∑–Ω—ñ, –¥–æ—Ä–æ—Å–ª—ñ —Ç–∞ –ø—Å–∏—Ö–æ–ª–æ–≥—ñ—á–Ω–æ –Ω–∞–ø—Ä—É–∂–µ–Ω—ñ —Ç–µ–º–∏ —Ç–∞ —Ç–µ–º–∏ —Å–µ–∫—Å—É. "
        "–í–∫–ª–∞–¥–∏—Å—å –≤ 200—Å–ª—ñ–≤ —â–æ–± —Ü–µ –±—É–ª–æ —Å—Ç–∏—Å–ª–æ —ñ –∑—Ä–æ–∑—É–º—ñ–ª–æ"
    )

    try:
        # –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∏–π –≤–∏–∫–ª–∏–∫ –¥–ª—è –Ω–æ–≤–æ—ó –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏
        response = await client.aio.models.generate_content(
            model='gemini-2.5-flash', 
            contents=prompt
        )
        return response.text
    except Exception as e:
        print(f"‚ùå –ü–û–ú–ò–õ–ö–ê AI (Disaster): {e}")
        return "‚ö†Ô∏è –°–≤—ñ—Ç –∑—Ä—É–π–Ω–æ–≤–∞–Ω–æ. –ó–≤'—è–∑–æ–∫ —ñ–∑ –®–Ü –≤—Ç—Ä–∞—á–µ–Ω–æ. –í–∏–∂–∏–≤–∞–π—Ç–µ —è–∫ –º–æ–∂–µ—Ç–µ."

async def analyze_survival(disaster, survivors_text):
    prompt = (
        f"–ì–†–ê '–ë–£–ù–ö–ï–†' –ó–ê–í–ï–†–®–ï–ù–ê. –ü–û–¢–†–Ü–ë–ï–ù –§–Ü–ù–ê–õ.\n\n"
        f"üåç –ö–ê–¢–ê–°–¢–†–û–§–ê: {disaster}\n\n"
        f"üë• –°–ü–ò–°–û–ö –¢–ò–•, –•–¢–û –í–ò–ñ–ò–í:\n{survivors_text}\n\n"
        f"–ó–ê–í–î–ê–ù–ù–Ø: –ü—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–π, —á–∏ –∑–º–æ–∂–µ —Ü—è –≥—Ä—É–ø–∞ –ª—é–¥–µ–π –≤–∏–∂–∏—Ç–∏ —Ç–∞ –≤—ñ–¥—Ä–æ–¥–∏—Ç–∏ –ª—é–¥—Å—Ç–≤–æ. "
        f"–í—Ä–∞—Ö—É–π —ó—Ö–Ω—ñ –ø—Ä–æ—Ñ–µ—Å—ñ—ó, –∑–¥–æ—Ä–æ–≤'—è, –≤—ñ–∫, —Ñ–æ–±—ñ—ó —Ç–∞ –±–∞–≥–∞–∂. "
        f"–ë—É–¥—å —Å–∞—Ä–∫–∞—Å—Ç–∏—á–Ω–∏–º, –∞–ª–µ —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–∏–º. –Ø–∫—â–æ –≥—Ä—É–ø–∞ —Å–ª–∞–±–∫–∞ ‚Äî –æ–ø–∏—à–∏, —è–∫ –≤–æ–Ω–∏ –∑–∞–≥–∏–Ω—É—Ç—å. "
        f"–Ø–∫—â–æ —Å–∏–ª—å–Ω–∞ ‚Äî –æ–ø–∏—à–∏ —ó—Ö–Ω—î –º–∞–π–±—É—Ç–Ω—î. –ü–∏—à–∏ —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é."
        f"–ù–µ –±—ñ–ª—å—à–µ 100 —Å–ª—ñ–≤."
    )
    
    try:
        response = await client.aio.models.generate_content(
            model='gemini-2.5-flash', 
            contents=prompt
        )
        return response.text
    except Exception as e:
        print(f"‚ùå –ü–û–ú–ò–õ–ö–ê AI (Analyze): {e}")
        return f"–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ —Ñ—ñ–Ω–∞–ª. –ü–æ–º–∏–ª–∫–∞: {e}"
