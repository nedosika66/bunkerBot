from google import genai
import config
import asyncio

# –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –∫–ª—ñ—î–Ω—Ç–∞
client = genai.Client(api_key=config.GEMINI_API_KEY)

async def generate_disaster():
    prompt = (
        "–¢–∏ ‚Äî –≤–µ–¥—É—á–∏–π –Ω–∞—Å—Ç—ñ–ª—å–Ω–æ—ó –≥—Ä–∏ '–ë—É–Ω–∫–µ—Ä'. –ó–≥–µ–Ω–µ—Ä—É–π —Å—Ü–µ–Ω–∞—Ä—ñ–π —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é. "
        "–í–ò–ú–û–ì–ò –î–û –ö–ê–¢–ê–°–¢–†–û–§–ò: "
        "1. –í–æ–Ω–∞ –º–∞—î –±—É—Ç–∏ –†–ï–ê–õ–Ü–°–¢–ò–ß–ù–û–Æ —Ç–∞ –§–Ü–ó–ò–ß–ù–û–Æ. "
        "–£–Ω–∏–∫–∞–π –∞–±—Å—Ç—Ä–∞–∫—Ü—ñ–π. –ì—Ä–∞–≤—Ü—ñ –º–∞—é—Ç—å —á—ñ—Ç–∫–æ —Ä–æ–∑—É–º—ñ—Ç–∏ –∑–∞–≥—Ä–æ–∑—É. "
        "2. –°–£–í–û–†–Ü –ß–ò–°–õ–û–í–Ü –û–ë–ú–ï–ñ–ï–ù–ù–Ø (–≤–∏–±–∏—Ä–∞–π –≤–∏–ø–∞–¥–∫–æ–≤–æ): "
        "- –ß–∞—Å –ø–µ—Ä–µ–±—É–≤–∞–Ω–Ω—è –≤ –±—É–Ω–∫–µ—Ä—ñ: –≤—ñ–¥ 6 –º—ñ—Å—è—Ü—ñ–≤ –¥–æ 7 —Ä–æ–∫—ñ–≤. "
        "- –ö—ñ–ª—å–∫—ñ—Å—Ç—å –ª—é–¥–µ–π, —â–æ –≤–∏–∂–∏–ª–∏ –Ω–∞ –ó–µ–º–ª—ñ: –≤—ñ–¥ 100 —Ç–∏—Å—è—á –¥–æ 100 –º—ñ–ª—å–π–æ–Ω—ñ–≤. "
        "3. –ë–£–ù–ö–ï–†: –û–ø–∏—à–∏ –π–æ–≥–æ —Å—Ç–∞–Ω, —Ä–µ—Å—É—Ä—Å–∏ —Ç–∞ –¥–µ—Ñ—ñ—Ü–∏—Ç. "
        "–í–ê–ñ–õ–ò–í–û: –ù–ï –≤–∫–∞–∑—É–π, –Ω–∞ —Å–∫—ñ–ª—å–∫–∏ –ª—é–¥–µ–π —Ä–æ–∑—Ä–∞—Ö–æ–≤–∞–Ω–∏–π –±—É–Ω–∫–µ—Ä. "
        "4. –û–±—Å—è–≥: –¥–æ 200 —Å–ª—ñ–≤. "
        "\n–°–¢–†–£–ö–¢–£–†–ê –í–Ü–î–ü–û–í–Ü–î–Ü: "
        "### üí• –ö–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∞: [–ù–∞–∑–≤–∞] "
        "[–û–ø–∏—Å –∑–∞–≥—Ä–æ–∑–∏. –í–∫–∞–∂–∏ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –≤—Ü—ñ–ª—ñ–ª–∏—Ö –Ω–∞ –ó–µ–º–ª—ñ]. "
        "### üõ°Ô∏è –ë—É–Ω–∫–µ—Ä: [–ù–∞–∑–≤–∞ —Ç–∞ —Ç–∏–ø] "
        "* **–£–º–æ–≤–∏:** [–ö–æ–º—Ñ–æ—Ä—Ç, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –∑—Ä—É—á–Ω–æ—Å—Ç–µ–π]. "
        "* **–†–µ—Å—É—Ä—Å–∏:** [–á–∂–∞, –≤–æ–¥–∞, –µ–Ω–µ—Ä–≥—ñ—è. –ß–æ–≥–æ –ù–ï–ú–ê–Ñ?]. "
        "* **–ß–∞—Å —ñ–∑–æ–ª—è—Ü—ñ—ó:** [–¢–µ—Ä–º—ñ–Ω]. "
        "**–ü–ª—é—Å–∏ —Ç–∞ –º—ñ–Ω—É—Å–∏:** "
        "‚úÖ **–ü–ª—é—Å–∏:** [–©–æ –¥–æ–ø–æ–º–æ–∂–µ –≤–∏–∂–∏—Ç–∏]. "
        "‚ùå **–ú—ñ–Ω—É—Å–∏:** [–©–æ—Å—å –∑–ª–∞–º–∞–Ω–µ –∞–±–æ –Ω–µ–±–µ–∑–ø–µ—á–Ω–µ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ]."
    )

    try:
        response = await client.aio.models.generate_content(
            model='gemini-2.5-flash', 
            contents=prompt
        )
        return response.text
    except Exception as e:
        print(f"‚ùå –ü–û–ú–ò–õ–ö–ê AI (Disaster): {e}")
        return "‚ö†Ô∏è –ü–æ–º–∏–ª–∫–∞ –∑–≤'—è–∑–∫—É. –ö–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∞ –Ω–µ–≤—ñ–¥–æ–º–∞."

async def analyze_survival(disaster, survivors_text):
    prompt = (
        f"–ì–†–ê '–ë–£–ù–ö–ï–†' –ó–ê–í–ï–†–®–ï–ù–ê. –ü–û–¢–†–Ü–ë–ï–ù –§–Ü–ù–ê–õ.\n\n"
        f"üåç –ö–ê–¢–ê–°–¢–†–û–§–ê: {disaster}\n\n"
        f"üë• –°–ü–ò–°–û–ö –¢–ò–•, –•–¢–û –í–ò–ñ–ò–í:\n{survivors_text}\n\n"
        f"–ó–ê–í–î–ê–ù–ù–Ø: \n"
        f"1. –ù–∞ –ø–æ—á–∞—Ç–∫—É –Ω–∞–ø–∏—à–∏ –∂–∏—Ä–Ω–∏–º: **–®–∞–Ω—Å –Ω–∞ –≤–∏–∂–∏–≤–∞–Ω–Ω—è –≥—Ä—É–ø–∏: [–≤—ñ–¥—Å–æ—Ç–æ–∫]** (–ë—É–¥—å —â–µ–¥—Ä–∏–º: —è–∫—â–æ —î —Ö–æ—á–∞ –± –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∞ –ª–æ–≥—ñ–∫–∞ —ñ —Ä—ñ–∑–Ω–æ—Å—Ç–∞—Ç–µ–≤—ñ –ª—é–¥–∏ ‚Äî –¥–∞–≤–∞–π –±—ñ–ª—å—à–µ 20%. –Ø–∫—â–æ –∫–æ–º–∞–Ω–¥–∞ —Ö–æ—Ä–æ—à–∞ ‚Äî 80-100%).\n"
        f"2. –ü—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–π –º–∞–π–±—É—Ç–Ω—î. –¶–µ –ì–†–ê, —Ç–æ–º—É –±—É–¥—å –ø–æ–±–ª–∞–∂–ª–∏–≤–∏–º –¥–æ –º–∞–ª–æ—ó –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –ª—é–¥–µ–π (–Ω–∞–≤—ñ—Ç—å 2-3 –ª—é–¥–∏–Ω–∏ –º–æ–∂—É—Ç—å –ø–æ—á–∞—Ç–∏ –Ω–æ–≤—É —Ü–∏–≤—ñ–ª—ñ–∑–∞—Ü—ñ—é –≤ —Ä–∞–º–∫–∞—Ö –≥—Ä–∏).\n"
        f"3. –®—É–∫–∞–π –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ —Ä—ñ—à–µ–Ω–Ω—è: —è–∫—â–æ –Ω–µ–º–∞—î –ª—ñ–∫–∞—Ä—è, –º–æ–∂–ª–∏–≤–æ —Ö—Ç–æ—Å—å –º–∞—î –≤–∏—Å–æ–∫–∏–π IQ? –Ø–∫—â–æ –Ω–µ–º–∞—î —Ñ–µ—Ä–º–µ—Ä–∞, –º–æ–∂–µ —î –±–∞–≥–∞—Ç–æ –∑–∞–ø–∞—Å—ñ–≤?\n"
        f"4. –°—Ç–∏–ª—å: –û–ø—Ç–∏–º—ñ—Å—Ç–∏—á–Ω–∏–π, –∑ –ª–µ–≥–∫–æ—é —ñ—Ä–æ–Ω—ñ—î—é. –û–ø–∏—à–∏, —è–∫ –≤–æ–Ω–∏ –¥–æ–ª–∞—é—Ç—å —Ç—Ä—É–¥–Ω–æ—â—ñ, –∞ –Ω–µ —è–∫ –ø–æ–º–∏—Ä–∞—é—Ç—å. –ù–∞–≤—ñ—Ç—å —è–∫—â–æ –≤—Å–µ –ø–æ–≥–∞–Ω–æ ‚Äî –ø—Ä–∏–¥—É–º–∞–π '–¥–∏–≤–æ' –∞–±–æ –≤–∞–∂–∫–∏–π, –∞–ª–µ —É—Å–ø—ñ—à–Ω–∏–π —à–ª—è—Ö.\n"
        f"–ü–∏—à–∏ —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é. –û–±—Å—è–≥ –¥–æ 100 —Å–ª—ñ–≤."
    )
    
    try:
        response = await client.aio.models.generate_content(
            model='gemini-2.5-flash', 
            contents=prompt
        )
        return response.text
    except Exception as e:
        print(f"‚ùå –ü–û–ú–ò–õ–ö–ê AI (Analyze): {e}")
        return f"–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ —Ñ—ñ–Ω–∞–ª. –ü–æ–º–∏–ª–∫–∞: {e}"
