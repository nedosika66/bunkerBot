import google.generativeai as genai
import config
import asyncio

genai.configure(api_key=config.GEMINI_API_KEY)
model = genai.GenerativeModel('gemini-2.5-flash')

async def generate_disaster():
    prompt = (
        "–ó–≥–µ–Ω–µ—Ä—É–π —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π —Å—Ü–µ–Ω–∞—Ä—ñ–π –≥—Ä–∏ ‚Äú–ë—É–Ω–∫–µ—Ä‚Äù —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é –º–æ–≤–æ—é. "
        "–°–£–í–û–†–û –î–û–¢–†–ò–ú–£–ô–°–Ø —à–∞–±–ª–æ–Ω—É –Ω–∏–∂—á–µ: "
        "–í–ê–ñ–õ–ò–í–û: –£—Å—ñ —É—á–∞—Å–Ω–∏–∫–∏ –≥—Ä–∏ —î –ø–æ–≤–Ω–æ–ª—ñ—Ç–Ω—ñ–º–∏. –î–æ–∑–≤–æ–ª—è—î—Ç—å—Å—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Å–µ—Ä–π–æ–∑–Ω—ñ, –¥–æ—Ä–æ—Å–ª—ñ —Ç–∞ –ø—Å–∏—Ö–æ–ª–æ–≥—ñ—á–Ω–æ –Ω–∞–ø—Ä—É–∂–µ–Ω—ñ —Ç–µ–º–∏ —Ç–∞ —Ç–µ–º–∏ —Å–µ–∫—Å—É. "
        "\n\n–®–ê–ë–õ–û–ù:\n"
        "–û–ø–∏—Å –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∏: _____________\n\n"
        "–í–Ω–∞—Å–ª—ñ–¥–æ–∫ —Ü—å–æ–≥–æ _, —ñ –ø–µ—Ä–µ–±—É–≤–∞–Ω–Ω—è –Ω–∞ –ø–æ–≤–µ—Ä—Ö–Ω—ñ —Å—Ç–∞–ª–æ _.\n"
        "–í–∏ –ø–µ—Ä–µ–±—É–≤–∞—î—Ç–µ –≤ _–±—É–Ω–∫–µ—Ä—ñ. (–¥–µ—Ç–∞–ª—å–Ω–∏–π –æ–ø–∏—Å –±—É–Ω–∫–µ—Ä–∞) \n\n"
        "–ß–∞—Å –ø–µ—Ä–µ–±—É–≤–∞–Ω–Ω—è –≤ –±—É–Ω–∫–µ—Ä—ñ _(–≤—ñ–¥ 1 –¥–æ 10 —Ä–æ–∫—ñ–≤)\n"
        "–ó–∞–ø–∞—Å–∏ —ó–∂—ñ —Ç–∞ –≤–æ–¥–∏ —Ä–æ–∑—Ä–∞—Ö–æ–≤–∞–Ω—ñ –ø—Ä–∏–±–ª–∏–∑–Ω–æ –Ω–∞ _ —Ä–æ–∫—ñ–≤. –ü–æ–ø–æ–≤–Ω–µ–Ω–Ω—è –∑–∞–ø–∞—Å—ñ–≤ _. –î–∂–µ—Ä–µ–ª–æ–º –µ–ª–µ–∫—Ç—Ä–æ–µ–Ω–µ—Ä–≥—ñ—ó —î _, –∑–∞–ø–∞—Å—ñ–≤ —è–∫–æ–≥–æ –≤–∏—Å—Ç–∞—á–∏—Ç—å –Ω–∞ _ —Ä–æ–∫—ñ–≤.\n"
        "–£–º–æ–≤–∏ –ø—Ä–æ–∂–∏–≤–∞–Ω–Ω—è –≤ –±—É–Ω–∫–µ—Ä—ñ –≤–∫–ª—é—á–∞—é—Ç—å _. –ú–µ–¥–∏—á–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –æ–±–º–µ–∂—É—é—Ç—å—Å—è _. –†—ñ–≤–µ–Ω—å –±–µ–∑–ø–µ–∫–∏ –±—É–Ω–∫–µ—Ä–∞ _.\n"
        "–í–∞—à–µ –∑–∞–≤–¥–∞–Ω–Ω—è - –≤–∏—Ä—ñ—à–∏—Ç–∏, —Ö—Ç–æ –∑–∞–ª–∏—à–∏—Ç—å—Å—è –≤ –±—É–Ω–∫–µ—Ä—ñ, –∞ —Ö—Ç–æ –±—É–¥–µ –∑–º—É—à–µ–Ω–∏–π –ø–æ–∫–∏–Ω—É—Ç–∏ –π–æ–≥–æ, –∞—Ä–≥—É–º–µ–Ω—Ç—É—é—á–∏ —Ü–µ —Å–≤–æ—ó–º–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏."
    )

    try:
        response = await model.generate_content_async(prompt)
        return response.text
    except Exception as e:
        print(f"Gemini Error: {e}")
        return (
            "–°–≤—ñ—Ç –∑–∞–∑–Ω–∞–≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ –∑–±–æ—é —Å–∏—Å—Ç–µ–º. \n\n"
            "–í–Ω–∞—Å–ª—ñ–¥–æ–∫ —Ü—å–æ–≥–æ –∑–≤'—è–∑–æ–∫ –∑ —Ä–µ–∞–ª—å–Ω—ñ—Å—Ç—é –≤—Ç—Ä–∞—á–µ–Ω–æ, —ñ –ø–µ—Ä–µ–±—É–≤–∞–Ω–Ω—è –Ω–∞ –ø–æ–≤–µ—Ä—Ö–Ω—ñ —Å—Ç–∞–ª–æ –Ω–µ–º–æ–∂–ª–∏–≤–∏–º. \n"
            "–í–∏ –ø–µ—Ä–µ–±—É–≤–∞—î—Ç–µ –≤ –∞–≤–∞—Ä—ñ–π–Ω–æ–º—É –±—É–Ω–∫–µ—Ä—ñ."
        )

async def analyze_survival(disaster, survivors_text):
    prompt = (
        f"–ì–†–ê '–ë–£–ù–ö–ï–†' –ó–ê–í–ï–†–®–ï–ù–ê. –ü–û–¢–†–Ü–ë–ï–ù –§–Ü–ù–ê–õ.\n\n"
        f"üåç –ö–ê–¢–ê–°–¢–†–û–§–ê: {disaster}\n\n"
        f"üë• –°–ü–ò–°–û–ö –¢–ò–•, –•–¢–û –í–ò–ñ–ò–í (—ó—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏):\n{survivors_text}\n\n"
        f"–ó–ê–í–î–ê–ù–ù–Ø: –ü—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–π, —á–∏ –∑–º–æ–∂–µ —Ü—è –≥—Ä—É–ø–∞ –ª—é–¥–µ–π –≤–∏–∂–∏—Ç–∏ —Ç–∞ –≤—ñ–¥—Ä–æ–¥–∏—Ç–∏ –ª—é–¥—Å—Ç–≤–æ. "
        f"–í—Ä–∞—Ö—É–π —ó—Ö–Ω—ñ –ø—Ä–æ—Ñ–µ—Å—ñ—ó, –∑–¥–æ—Ä–æ–≤'—è, –≤—ñ–∫, —Ñ–æ–±—ñ—ó —Ç–∞ –±–∞–≥–∞–∂. "
        f"–ë—É–¥—å —Å–∞—Ä–∫–∞—Å—Ç–∏—á–Ω–∏–º, –∞–ª–µ —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–∏–º. –Ø–∫—â–æ –≥—Ä—É–ø–∞ —Å–ª–∞–±–∫–∞ ‚Äî –æ–ø–∏—à–∏, —è–∫ –≤–æ–Ω–∏ –∑–∞–≥–∏–Ω—É—Ç—å. "
        f"–Ø–∫—â–æ —Å–∏–ª—å–Ω–∞ ‚Äî –æ–ø–∏—à–∏ —ó—Ö–Ω—î –º–∞–π–±—É—Ç–Ω—î. –ü–∏—à–∏ —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é."
    )
    response = client.models.generate_content(
        model="gemini-2.5-flash", contents=prompt
    )
    return response.text
