from google import genai
import config
import asyncio

client = genai.Client(api_key=config.GEMINI_API_KEY)

async def generate_disaster():
    prompt = (
        "–¢–∏ ‚Äî –≤–µ–¥—É—á–∏–π –Ω–∞—Å—Ç—ñ–ª—å–Ω–æ—ó –≥—Ä–∏ '–ë—É–Ω–∫–µ—Ä'. –ó–≥–µ–Ω–µ—Ä—É–π —Å—Ü–µ–Ω–∞—Ä—ñ–π —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é. "
        "–í–ò–ú–û–ì–ò –î–û –ö–ê–¢–ê–°–¢–†–û–§–ò: "
        "1. –í–æ–Ω–∞ –º–∞—î –±—É—Ç–∏ –†–ï–ê–õ–Ü–°–¢–ò–ß–ù–û–Æ —Ç–∞ –§–Ü–ó–ò–ß–ù–û–Æ (–≤—ñ—Ä—É—Å, —è–¥–µ—Ä–Ω–∞ –≤—ñ–π–Ω–∞, –µ–∫–æ–ª–æ–≥—ñ—á–Ω–∏–π –∫–æ–ª–∞–ø—Å, –ª—å–æ–¥–æ–≤–∏–∫–æ–≤–∏–π –ø–µ—Ä—ñ–æ–¥, –∑–æ–º–±—ñ, –ø–∞–¥—ñ–Ω–Ω—è –º–µ—Ç–µ–æ—Ä–∏—Ç–∞). "
        "–£–Ω–∏–∫–∞–π –∞–±—Å—Ç—Ä–∞–∫—Ü—ñ–π —Ç–∏–ø—É '–®–Ü –ø–µ—Ä–µ–ø–∏—Å–∞–≤ —Ä–µ–∞–ª—å–Ω—ñ—Å—Ç—å' –∞–±–æ –º–∞–≥—ñ—ó. –ì—Ä–∞–≤—Ü—ñ –º–∞—é—Ç—å —á—ñ—Ç–∫–æ —Ä–æ–∑—É–º—ñ—Ç–∏ –∑–∞–≥—Ä–æ–∑—É (—Ö–æ–ª–æ–¥, —Ä–∞–¥—ñ–∞—Ü—ñ—è, –≥–æ–ª–æ–¥, —Ö–≤–æ—Ä–æ–±–∞). "
        "2. –°–£–í–û–†–Ü –ß–ò–°–õ–û–í–Ü –û–ë–ú–ï–ñ–ï–ù–ù–Ø (–≤–∏–±–∏—Ä–∞–π –≤–∏–ø–∞–¥–∫–æ–≤–æ): "
        "- –ß–∞—Å –ø–µ—Ä–µ–±—É–≤–∞–Ω–Ω—è –≤ –±—É–Ω–∫–µ—Ä—ñ: –≤—ñ–¥ 6 –º—ñ—Å—è—Ü—ñ–≤ –¥–æ 7 —Ä–æ–∫—ñ–≤. "
        "- –ö—ñ–ª—å–∫—ñ—Å—Ç—å –ª—é–¥–µ–π, —â–æ –≤–∏–∂–∏–ª–∏ –Ω–∞ –ó–µ–º–ª—ñ: –≤—ñ–¥ 100 —Ç–∏—Å—è—á –¥–æ 100 –º—ñ–ª—å–π–æ–Ω—ñ–≤. "
        "3. –ë–£–ù–ö–ï–†: –û–ø–∏—à–∏ –π–æ–≥–æ —Å—Ç–∞–Ω, —Ä–µ—Å—É—Ä—Å–∏ —Ç–∞ –¥–µ—Ñ—ñ—Ü–∏—Ç. "
        "–í–ê–ñ–õ–ò–í–û: –ù–ï –≤–∫–∞–∑—É–π, –Ω–∞ —Å–∫—ñ–ª—å–∫–∏ –ª—é–¥–µ–π —Ä–æ–∑—Ä–∞—Ö–æ–≤–∞–Ω–∏–π –±—É–Ω–∫–µ—Ä (–Ω–µ –ø–∏—à–∏ –º—ñ—Å—Ç–∫—ñ—Å—Ç—å), —Ü–µ –≤–∏—Ä—ñ—à—É—é—Ç—å –≥—Ä–∞–≤—Ü—ñ. "
        "4. –û–±—Å—è–≥: –¥–æ 200 —Å–ª—ñ–≤. "
        "\n–°–¢–†–£–ö–¢–£–†–ê –í–Ü–î–ü–û–í–Ü–î–Ü: "
        "### üí• –ö–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∞: [–ù–∞–∑–≤–∞] "
        "[–û–ø–∏—Å –∑–∞–≥—Ä–æ–∑–∏ —Ç–∞ –Ω–∞—Å–ª—ñ–¥–∫—ñ–≤. –í–∫–∞–∂–∏ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –≤—Ü—ñ–ª—ñ–ª–∏—Ö –Ω–∞ –ó–µ–º–ª—ñ]. "
        "### üõ°Ô∏è –ë—É–Ω–∫–µ—Ä: [–ù–∞–∑–≤–∞ —Ç–∞ —Ç–∏–ø (—Å–∫–ª–∞–¥, –º–µ—Ç—Ä–æ, –ª–∞–±–æ—Ä–∞—Ç–æ—Ä—ñ—è)] "
        "* **–£–º–æ–≤–∏:** [–ö–æ–º—Ñ–æ—Ä—Ç, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –∑—Ä—É—á–Ω–æ—Å—Ç–µ–π]. "
        "* **–†–µ—Å—É—Ä—Å–∏:** [–á–∂–∞, –≤–æ–¥–∞, –µ–Ω–µ—Ä–≥—ñ—è, –æ–±–ª–∞–¥–Ω–∞–Ω–Ω—è. –ß–æ–≥–æ –ù–ï–ú–ê–Ñ?]. "
        "* **–ß–∞—Å —ñ–∑–æ–ª—è—Ü—ñ—ó:** [–¢–µ—Ä–º—ñ–Ω]. "
        "**–ü–ª—é—Å–∏ —Ç–∞ –º—ñ–Ω—É—Å–∏:** "
        "‚úÖ **–ü–ª—é—Å–∏:** [–©–æ –¥–æ–ø–æ–º–æ–∂–µ –≤–∏–∂–∏—Ç–∏]. "
        "‚ùå **–ú—ñ–Ω—É—Å–∏:** [–©–æ—Å—å –∑–ª–∞–º–∞–Ω–µ –∞–±–æ –Ω–µ–±–µ–∑–ø–µ—á–Ω–µ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ]."
    )

    try:
        response = await client.aio.models.generate_content(
            model='gemini-2.5-flash', 
            contents=prompt
        )
        return response.text
    except Exception as e:
        print(f"‚ùå –ü–û–ú–ò–õ–ö–ê AI (Disaster): {e}")
        return "‚ö†Ô∏è –ó–≤'—è–∑–æ–∫ –≤—Ç—Ä–∞—á–µ–Ω–æ. –†–∞–¥—ñ–∞—Ü—ñ–π–Ω–∏–π —Ñ–æ–Ω –∑–∞—à–∫–∞–ª—é—î. –û–ø–∏—Å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π."

async def analyze_survival(disaster, survivors_text):
    prompt = (
        f"–ì–†–ê '–ë–£–ù–ö–ï–†' –ó–ê–í–ï–†–®–ï–ù–ê. –ü–û–¢–†–Ü–ë–ï–ù –§–Ü–ù–ê–õ.\n\n"
        f"üåç –ö–ê–¢–ê–°–¢–†–û–§–ê: {disaster}\n\n"
        f"üë• –°–ü–ò–°–û–ö –¢–ò–•, –•–¢–û –í–ò–ñ–ò–í:\n{survivors_text}\n\n"
        f"–ó–ê–í–î–ê–ù–ù–Ø: \n"
        f"1. –ù–∞ –ø–æ—á–∞—Ç–∫—É –Ω–∞–ø–∏—à–∏ –∂–∏—Ä–Ω–∏–º: **–®–∞–Ω—Å –Ω–∞ –≤–∏–∂–∏–≤–∞–Ω–Ω—è –ª—é–¥—Å—Ç–≤–∞: [–≤—ñ–¥—Å–æ—Ç–æ–∫ –≤—ñ–¥ 0% –¥–æ 100%]**\n"
        f"2. –ü—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–π —Ü—é –≥—Ä—É–ø—É. –ß–∏ —î —Å–µ—Ä–µ–¥ –Ω–∏—Ö –ª—ñ–∫–∞—Ä, —ñ–Ω–∂–µ–Ω–µ—Ä, –±—ñ–æ–ª–æ–≥ —á–∏ –ª—é–¥–∏, –∑–¥–∞—Ç–Ω—ñ —Ä–æ–∑–º–Ω–æ–∂—É–≤–∞—Ç–∏—Å—å? "
        f"–Ø–∫ —ó—Ö–Ω—ñ —Ñ–æ–±—ñ—ó —Ç–∞ –∑–¥–æ—Ä–æ–≤'—è –≤–ø–ª–∏–Ω—É—Ç—å –Ω–∞ –∂–∏—Ç—Ç—è –≤ –∑–∞–º–∫–Ω–µ–Ω–æ–º—É –ø—Ä–æ—Å—Ç–æ—Ä—ñ? "
        f"–ë—É–¥—å —Å–∞—Ä–∫–∞—Å—Ç–∏—á–Ω–∏–º, –∞–ª–µ –ª–æ–≥—ñ—á–Ω–∏–º. –û–ø–∏—à–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π —Å—Ü–µ–Ω–∞—Ä—ñ–π —ó—Ö–Ω—å–æ–≥–æ –º–∞–π–±—É—Ç–Ω—å–æ–≥–æ (–±—É–Ω—Ç, –≥–æ–ª–æ–¥, –ø—Ä–æ—Ü–≤—ñ—Ç–∞–Ω–Ω—è). "
        f"–ü–∏—à–∏ —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é. –û–±—Å—è–≥ –¥–æ 100 —Å–ª—ñ–≤."
    )
    
    try:
        response = await client.aio.models.generate_content(
            model='gemini-2.5-flash', 
            contents=prompt
        )
        return response.text
    except Exception as e:
        print(f"‚ùå –ü–û–ú–ò–õ–ö–ê AI (Analyze): {e}")
        return f"–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ —Ñ—ñ–Ω–∞–ª. –ü–æ–º–∏–ª–∫–∞: {e}"
